!function(a,b,c){"use strict";"object"==typeof module&&"object"==typeof module.exports?module.exports=function(a,b){return c(a,b)}:c(a,b)}("undefined"!=typeof window?window.jQuery:{},"undefined"!=typeof window?window:this,function(a,b){"use strict";function C(a){var c,b=this;for(c in a)Object.prototype.hasOwnProperty.call(a,c)&&(b[c]=a[c]);return b}function E(){k(this,E.baseDefaults)}function F(a){return"string"===m(a)}function G(a){return!isNaN(h(a))&&!isNaN(i(a))}function H(a){return a&&a.getContext?a.getContext("2d"):null}function I(a){var b,c,d;for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&(d=a[b],c=m(d),"string"===c&&G(d)&&"text"!==b&&(a[b]=i(d)));void 0!==a.text&&(a.text=String(a.text))}function J(a){return a=k({},a),a.masks=a.masks.slice(0),a}function K(a,b){var c;a.save(),c=J(b.transforms),b.savedTransforms.push(c)}function L(a,b){0===b.savedTransforms.length?b.transforms=J(z):(a.restore(),b.transforms=b.savedTransforms.pop())}function M(a,b,c,d){c[d]&&(b[d]=n(c[d])?c[d].call(a,c):c[d])}function N(a,b,c){M(a,b,c,"fillStyle"),M(a,b,c,"strokeStyle"),b.lineWidth=c.strokeWidth,c.rounded?b.lineCap=b.lineJoin="round":(b.lineCap=c.strokeCap,b.lineJoin=c.strokeJoin,b.miterLimit=c.miterLimit),c.strokeDash||(c.strokeDash=[]),b.setLineDash&&b.setLineDash(c.strokeDash),b.webkitLineDash=c.strokeDash,b.lineDashOffset=b.webkitLineDashOffset=b.mozDashOffset=c.strokeDashOffset,b.shadowOffsetX=c.shadowX,b.shadowOffsetY=c.shadowY,b.shadowBlur=c.shadowBlur,b.shadowColor=c.shadowColor,b.globalAlpha=c.opacity,b.globalCompositeOperation=c.compositing,c.imageSmoothing&&(b.imageSmoothingEnabled=c.imageSmoothingEnabled)}function O(a,b,c){c.mask&&(c.autosave&&K(a,b),a.clip(),b.transforms.masks.push(c._args))}function P(a,b){b._transformed&&a.restore()}function Q(a,b,c){var d;c.closed&&b.closePath(),c.shadowStroke&&0!==c.strokeWidth?(b.stroke(),b.fill(),b.shadowColor="transparent",b.shadowBlur=0,b.stroke()):(b.fill(),"transparent"!==c.fillStyle&&(b.shadowColor="transparent"),0!==c.strokeWidth&&b.stroke()),c.closed||b.closePath(),P(b,c),c.mask&&(d=S(a),O(b,d,c))}function R(a,b,c,d,e){c._toRad=c.inDegrees?p/180:1,c._transformed=!0,b.save(),c.fromCenter||c._centered||void 0===d||(void 0===e&&(e=d),c.x+=d/2,c.y+=e/2,c._centered=!0),c.rotate&&sb(b,c,null),(1!==c.scale||1!==c.scaleX||1!==c.scaleY)&&tb(b,c,null),(c.translate||c.translateX||c.translateY)&&ub(b,c,null)}function S(b){var d,c=y.dataCache;return c._canvas===b&&c._data?d=c._data:(d=a.data(b,"jCanvas"),d||(d={canvas:b,layers:[],layer:{names:{},groups:{}},eventHooks:{},intersecting:[],lastIntersected:null,cursor:a(b).css("cursor"),drag:{layer:null,dragging:!1},event:{type:null,x:null,y:null},events:{},transforms:J(z),savedTransforms:[],animating:!1,animated:null,pixelRatio:1,scaled:!1,redrawOnMousemove:!1},a.data(b,"jCanvas",d)),c._canvas=b,c._data=d),d}function T(a,b,c){var d;for(d in D.events)Object.prototype.hasOwnProperty.call(D.events,d)&&(c[d]||c.cursors&&c.cursors[d])&&V(a,b,c,d);b.events.mouseout||(a.bind("mouseout.jCanvas",function(){var d,c=b.drag.layer;for(c&&(b.drag={},eb(a,b,c,"dragcancel")),d=0;d<b.layers.length;d+=1)c=b.layers[d],c._hovered&&a.triggerLayerEvent(b.layers[d],"mouseout");a.drawLayers()}),b.events.mouseout=!0)}function U(a,b,c,d){D.events[d](a,b),c._event=!0}function V(a,b,c,d){U(a,b,c,d),("mouseover"===d||"mouseout"===d||"mousemove"===d)&&(b.redrawOnMousemove=!0)}function W(a,b,c){var d,e,f;if(c.draggable||c.cursors){for(d=["mousedown","mousemove","mouseup"],f=0;f<d.length;f+=1)e=d[f],U(a,b,c,e);c._event=!0}}function X(a,b,c,d){var e=b.layer.names;d?void 0!==d.name&&F(c.name)&&c.name!==d.name&&delete e[c.name]:d=c,F(d.name)&&(e[d.name]=c)}function Y(a,b,c,d){var f,g,h,i,j,e=b.layer.groups;if(d){if(void 0!==d.groups&&null!==c.groups)for(h=0;h<c.groups.length;h+=1)if(g=c.groups[h],f=e[g]){for(j=0;j<f.length;j+=1)if(f[j]===c){i=j,f.splice(j,1);break}0===f.length&&delete e[g]}}else d=c;if(void 0!==d.groups&&null!==d.groups)for(h=0;h<d.groups.length;h+=1)g=d.groups[h],f=e[g],f||(f=e[g]=[],f.name=g),void 0===i&&(i=f.length),f.splice(i,0,c)}function Z(a){var b,c,d,e;for(b=null,c=a.intersecting.length-1;c>=0;c-=1)if(b=a.intersecting[c],b._masks){for(e=b._masks.length-1;e>=0;e-=1)if(d=b._masks[e],!d.intersects){b.intersects=!1;break}if(b.intersects&&!b.intangible)break}return b&&b.intangible&&(b=null),b}function $(a,b,c,d){c&&c.visible&&c._method&&(c._next=d?d:null,c._method&&c._method.call(a,c))}function _(a,b,c){var d,e,f,g,h,i,j,k,l,m;if(g=b.drag,e=g.layer,h=e&&e.dragGroups||[],d=b.layers,"mousemove"===c||"touchmove"===c){if(g.dragging||(g.dragging=!0,e.dragging=!0,e.bringToFront&&(d.splice(e.index,1),e.index=d.push(e)),e._startX=e.x,e._startY=e.y,e._endX=e._eventX,e._endY=e._eventY,eb(a,b,e,"dragstart")),g.dragging)for(l=e._eventX-(e._endX-e._startX),m=e._eventY-(e._endY-e._startY),e.updateDragX&&(l=e.updateDragX.call(a[0],e,l)),e.updateDragY&&(m=e.updateDragY.call(a[0],e,m)),e.dx=l-e.x,e.dy=m-e.y,"y"!==e.restrictDragToAxis&&(e.x=l),"x"!==e.restrictDragToAxis&&(e.y=m),eb(a,b,e,"drag"),k=0;k<h.length;k+=1)if(j=h[k],i=b.layer.groups[j],e.groups&&i)for(f=0;f<i.length;f+=1)i[f]!==e&&("y"!==e.restrictDragToAxis&&"y"!==i[f].restrictDragToAxis&&(i[f].x+=e.dx),"x"!==e.restrictDragToAxis&&"x"!==i[f].restrictDragToAxis&&(i[f].y+=e.dy))}else("mouseup"===c||"touchend"===c)&&(g.dragging&&(e.dragging=!1,g.dragging=!1,b.redrawOnMousemove=b.originalRedrawOnMousemove,eb(a,b,e,"dragstop")),b.drag={})}function ab(b,c,d){var e;c.cursors&&(e=c.cursors[d]),-1!==a.inArray(e,A.cursors)&&(e=A.prefix+e),e&&b.css({cursor:e})}function bb(a,b){a.css({cursor:b.cursor})}function cb(a,b,c,d,e){d[c]&&b._running&&!b._running[c]&&(b._running[c]=!0,d[c].call(a[0],b,e),b._running[c]=!1)}function db(b,c){return!(b.disableEvents||b.intangible&&-1!==a.inArray(c,B))}function eb(a,b,c,d,e){db(c,d)&&("mouseout"!==d&&ab(a,c,d),cb(a,c,d,c,e),cb(a,c,d,b.eventHooks,e),cb(a,c,d,D.eventHooks,e))}function fb(b,c,d,e){var f,g,h,i=c._layer?d:c;return c._args=d,(c.draggable||c.dragGroups)&&(c.layer=!0,c.draggable=!0),c._method||(e?c._method=e:c.method?c._method=a.fn[c.method]:c.type&&(c._method=a.fn[x.drawings[c.type]])),c.layer&&!c._layer?(f=a(b),g=S(b),h=g.layers,(null===i.name||F(i.name)&&void 0===g.layer.names[i.name])&&(I(c),i=new C(c),i.canvas=b,i.layer=!0,i._layer=!0,i._running={},i.data=null!==i.data?k({},i.data):{},i.groups=null!==i.groups?i.groups.slice(0):[],X(f,g,i),Y(f,g,i),T(f,g,i),W(f,g,i),c._event=i._event,i._method===a.fn.drawText&&f.measureText(i),null===i.index&&(i.index=h.length),h.splice(i.index,0,i),c._args=i,eb(f,g,i,"add"))):c.layer||I(c),i}function gb(a){var b,c;for(c=0;c<A.props.length;c+=1)b=A.props[c],a[b]=a["_"+b]}function hb(a,b){var c,d;for(d=0;d<A.props.length;d+=1)c=A.props[d],void 0!==a[c]&&(a["_"+c]=a[c],A.propsObj[c]=!0,b&&delete a[c])}function ib(a,b,c){var d,e,f,g;for(d in c)if(Object.prototype.hasOwnProperty.call(c,d)&&(e=c[d],n(e)&&(c[d]=e.call(a,b,d)),"object"===m(e)&&o(e))){for(f in e)Object.prototype.hasOwnProperty.call(e,f)&&(g=e[f],void 0!==b[d]&&(b[d+"."+f]=b[d][f],c[d+"."+f]=g));delete c[d]}return c}function jb(a){var b;for(b in a)Object.prototype.hasOwnProperty.call(a,b)&&-1!==b.indexOf(".")&&delete a[b]}function kb(b){var d,e,f=[],g=1;return"transparent"===b?b="rgba(0, 0, 0, 0)":b.match(/^([a-z]+|#[0-9a-f]+)$/gi)&&(e=c.head,d=e.style.color,e.style.color=b,b=a.css(e,"color"),e.style.color=d),b.match(/^rgb/gi)&&(f=b.match(/(\d+(\.\d+)?)/gi),b.match(/%/gi)&&(g=2.55),f[0]*=g,f[1]*=g,f[2]*=g,f[3]=void 0!==f[3]?i(f[3]):1),f}function lb(a){var c,b=3;for("array"!==m(a.start)&&(a.start=kb(a.start),a.end=kb(a.end)),a.now=[],(1!==a.start[3]||1!==a.end[3])&&(b=4),c=0;b>c;c+=1)a.now[c]=a.start[c]+(a.end[c]-a.start[c])*a.pos,3>c&&(a.now[c]=q(a.now[c]));1!==a.start[3]||1!==a.end[3]?a.now="rgba("+a.now.join(",")+")":(a.now.slice(0,3),a.now="rgb("+a.now.join(",")+")"),a.elem.nodeName?a.elem.style[a.prop]=a.now:a.elem[a.prop]=a.now}function mb(b){var c;for(c=0;c<b.length;c+=1)a.fx.step[b[c]]=lb}function nb(a){return x.touchEvents[a]&&(a=x.touchEvents[a]),a}function ob(a){return x.mouseEvents[a]&&(a=x.mouseEvents[a]),a}function pb(a){D.events[a]=function(b,c){function g(a){f.x=a.offsetX,f.y=a.offsetY,f.type=d,f.event=a,("mousemove"!==a.type||c.redrawOnMousemove||c.drag.dragging)&&b.drawLayers({resetFire:!0}),a.preventDefault()}var d,e,f;f=c.event,d="mouseover"===a||"mouseout"===a?"mousemove":a,e=nb(d),c.events[d]||(e!==d?b.bind(d+".jCanvas "+e+".jCanvas",g):b.bind(d+".jCanvas",g),c.events[d]=!0)}}function qb(a){var b;for(b=0;b<a.length;b+=1)pb(a[b])}function rb(a,b,c){var d,e,f,g,h,i,j,k;d=c._args,d&&(e=S(a),f=e.event,null!==f.x&&null!==f.y&&(i=f.x*e.pixelRatio,j=f.y*e.pixelRatio,g=b.isPointInPath(i,j)||b.isPointInStroke&&b.isPointInStroke(i,j)),h=e.transforms,d.eventX=f.x,d.eventY=f.y,d.event=f.event,k=e.transforms.rotate,i=d.eventX,j=d.eventY,0!==k?(d._eventX=i*t(-k)-j*s(-k),d._eventY=j*t(-k)+i*s(-k)):(d._eventX=i,d._eventY=j),d._eventX/=h.scaleX,d._eventY/=h.scaleY,g&&e.intersecting.push(d),d.intersects=Boolean(g))}function sb(a,b,c){b._toRad=b.inDegrees?p/180:1,a.translate(b.x,b.y),a.rotate(b.rotate*b._toRad),a.translate(-b.x,-b.y),c&&(c.rotate+=b.rotate*b._toRad)}function tb(a,b,c){1!==b.scale&&(b.scaleX=b.scaleY=b.scale),a.translate(b.x,b.y),a.scale(b.scaleX,b.scaleY),a.translate(-b.x,-b.y),c&&(c.scaleX*=b.scaleX,c.scaleY*=b.scaleY)}function ub(a,b,c){b.translate&&(b.translateX=b.translateY=b.translate),a.translate(b.translateX,b.translateY),c&&(c.translateX+=b.translateX,c.translateY+=b.translateY)}function vb(a){for(;0>a;)a+=2*p;return a}function wb(a,b){return a.x+a.radius*t(b)}function xb(a,b){return a.y+a.radius*s(b)}function yb(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o;c===d?(m=0,n=0):(m=c.x,n=c.y),d.inDegrees||360!==d.end||(d.end=2*p),d.start*=c._toRad,d.end*=c._toRad,d.start-=p/2,d.end-=p/2,o=p/180,d.ccw&&(o*=-1),e=wb(d,d.start+o),f=xb(d,d.start+o),g=wb(d,d.start),h=xb(d,d.start),Ab(a,b,c,d,e,f,g,h),b.arc(d.x+m,d.y+n,d.radius,d.start,d.end,d.ccw),i=wb(d,d.end+o),j=xb(d,d.end+o),k=wb(d,d.end),l=xb(d,d.end),Bb(a,b,c,d,k,l,i,j)}function zb(a,b,c,d,e,f,g,h){var i,j,k,l,m,n,o;d.arrowRadius&&!c.closed&&(o=u(h-f,g-e),o-=p,m=c.strokeWidth*t(o),n=c.strokeWidth*s(o),i=g+d.arrowRadius*t(o+d.arrowAngle/2),j=h+d.arrowRadius*s(o+d.arrowAngle/2),k=g+d.arrowRadius*t(o-d.arrowAngle/2),l=h+d.arrowRadius*s(o-d.arrowAngle/2),b.moveTo(i-m,j-n),b.lineTo(g-m,h-n),b.lineTo(k-m,l-n),b.moveTo(g-m,h-n),b.lineTo(g+m,h+n),b.moveTo(g,h))}function Ab(a,b,c,d,e,f,g,h){d._arrowAngleConverted||(d.arrowAngle*=c._toRad,d._arrowAngleConverted=!0),d.startArrow&&zb(a,b,c,d,e,f,g,h)}function Bb(a,b,c,d,e,f,g,h){d._arrowAngleConverted||(d.arrowAngle*=c._toRad,d._arrowAngleConverted=!0),d.endArrow&&zb(a,b,c,d,e,f,g,h)}function Cb(a,b,c,d){var e,f,g;for(e=2,Ab(a,b,c,d,d.x2+c.x,d.y2+c.y,d.x1+c.x,d.y1+c.y),void 0!==d.x1&&void 0!==d.y1&&b.moveTo(d.x1+c.x,d.y1+c.y);;){if(f=d["x"+e],g=d["y"+e],void 0===f||void 0===g)break;b.lineTo(f+c.x,g+c.y),e+=1}e-=1,Bb(a,b,c,d,d["x"+(e-1)]+c.x,d["y"+(e-1)]+c.y,d["x"+e]+c.x,d["y"+e]+c.y)}function Db(a,b,c,d){var e,f,g,h,i;for(e=2,Ab(a,b,c,d,d.cx1+c.x,d.cy1+c.y,d.x1+c.x,d.y1+c.y),void 0!==d.x1&&void 0!==d.y1&&b.moveTo(d.x1+c.x,d.y1+c.y);;){if(f=d["x"+e],g=d["y"+e],h=d["cx"+(e-1)],i=d["cy"+(e-1)],void 0===f||void 0===g||void 0===h||void 0===i)break;b.quadraticCurveTo(h+c.x,i+c.y,f+c.x,g+c.y),e+=1}e-=1,Bb(a,b,c,d,d["cx"+(e-1)]+c.x,d["cy"+(e-1)]+c.y,d["x"+e]+c.x,d["y"+e]+c.y)}function Eb(a,b,c,d){var e,f,g,h,i,j,k,l;for(e=2,f=1,Ab(a,b,c,d,d.cx1+c.x,d.cy1+c.y,d.x1+c.x,d.y1+c.y),void 0!==d.x1&&void 0!==d.y1&&b.moveTo(d.x1+c.x,d.y1+c.y);;){if(g=d["x"+e],h=d["y"+e],i=d["cx"+f],j=d["cy"+f],k=d["cx"+(f+1)],l=d["cy"+(f+1)],void 0===g||void 0===h||void 0===i||void 0===j||void 0===k||void 0===l)break;b.bezierCurveTo(i+c.x,j+c.y,k+c.x,l+c.y,g+c.x,h+c.y),e+=1,f+=2}e-=1,f-=2,Bb(a,b,c,d,d["cx"+(f+1)]+c.x,d["cy"+(f+1)]+c.y,d["x"+e]+c.x,d["y"+e]+c.y)}function Fb(a,b,c){return b*=a._toRad,b-=p/2,c*t(b)}function Gb(a,b,c){return b*=a._toRad,b-=p/2,c*s(b)}function Hb(a,b,c,d){var e,f,g,h,i,j,k,l,m,n,o;for(c===d?(h=0,i=0):(h=c.x,i=c.y),e=1,j=l=n=d.x+h,k=m=o=d.y+i,Ab(a,b,c,d,j+Fb(c,d.a1,d.l1),k+Gb(c,d.a1,d.l1),j,k),void 0!==d.x&&void 0!==d.y&&b.moveTo(j,k);;){if(f=d["a"+e],g=d["l"+e],void 0===f||void 0===g)break;l=n,m=o,n+=Fb(c,f,g),o+=Gb(c,f,g),b.lineTo(n,o),e+=1}Bb(a,b,c,d,l,m,n,o)}function Ib(a,b,c){isNaN(h(c.fontSize))||(c.fontSize+="px"),b.font=c.fontStyle+" "+c.fontSize+" "+c.fontFamily}function Jb(b,c,d,e){var f,g,h,j=y.propCache;if(j.text===d.text&&j.fontStyle===d.fontStyle&&j.fontSize===d.fontSize&&j.fontFamily===d.fontFamily&&j.maxWidth===d.maxWidth&&j.lineHeight===d.lineHeight)d.width=j.width,d.height=j.height;else{for(d.width=c.measureText(e[0]).width,h=1;h<e.length;h+=1)g=c.measureText(e[h]).width,g>d.width&&(d.width=g);f=b.style.fontSize,b.style.fontSize=d.fontSize,d.height=i(a.css(b,"fontSize"))*e.length*d.lineHeight,b.style.fontSize=f}}function Kb(a,b){var g,h,i,j,k,l,c=String(b.text),d=b.maxWidth,e=c.split("\n"),f=[];for(i=0;i<e.length;i+=1){if(j=e[i],k=j.split(" "),g=[],h="",1===k.length||a.measureText(j).width<d)g=[j];else{for(l=0;l<k.length;l+=1)a.measureText(h+k[l]).width>d&&(""!==h&&g.push(h),h=""),h+=k[l],l!==k.length-1&&(h+=" ");g.push(h)}f=f.concat(g.join("\n").replace(/((\n))|($)/gi,"$2").split("\n"))}return f}var j,c=b.document,d=b.Image,e=b.Array,f=b.getComputedStyle,g=b.Math,h=b.Number,i=b.parseFloat,k=a.extend,l=a.inArray,m=function(a){return Object.prototype.toString.call(a).slice(8,-1).toLowerCase()},n=a.isFunction,o=a.isPlainObject,p=g.PI,q=g.round,r=g.abs,s=g.sin,t=g.cos,u=g.atan2,v=e.prototype.slice,w=a.event.fix,x={},y={dataCache:{},propCache:{},imageCache:{}},z={rotate:0,scaleX:1,scaleY:1,translateX:0,translateY:0,masks:[]},A={},B=["mousedown","mousemove","mouseup","mouseover","mouseout","touchstart","touchmove","touchend"],D={events:{},eventHooks:{},future:{}};E.baseDefaults={align:"center",arrowAngle:90,arrowRadius:0,autosave:!0,baseline:"middle",bringToFront:!1,ccw:!1,closed:!1,compositing:"source-over",concavity:0,cornerRadius:0,count:1,cropFromCenter:!0,crossOrigin:null,cursors:null,disableEvents:!1,draggable:!1,dragGroups:null,groups:null,data:null,dx:null,dy:null,end:360,eventX:null,eventY:null,fillStyle:"transparent",fontStyle:"normal",fontSize:"12pt",fontFamily:"sans-serif",fromCenter:!0,height:null,imageSmoothing:!0,inDegrees:!0,intangible:!1,index:null,letterSpacing:null,lineHeight:1,layer:!1,mask:!1,maxWidth:null,miterLimit:10,name:null,opacity:1,r1:null,r2:null,radius:0,repeat:"repeat",respectAlign:!1,restrictDragToAxis:null,rotate:0,rounded:!1,scale:1,scaleX:1,scaleY:1,shadowBlur:0,shadowColor:"transparent",shadowStroke:!1,shadowX:0,shadowY:0,sHeight:null,sides:0,source:"",spread:0,start:0,strokeCap:"butt",strokeDash:null,strokeDashOffset:0,strokeJoin:"miter",strokeStyle:"transparent",strokeWidth:1,sWidth:null,sx:null,sy:null,text:"",translate:0,translateX:0,translateY:0,type:null,visible:!0,width:null,x:0,y:0},j=new E,C.prototype=j,D.extend=function(b){return b.name&&(b.props&&k(j,b.props),a.fn[b.name]=function c(a){var e,f,g,h,d=this;for(f=0;f<d.length;f+=1)e=d[f],g=H(e),g&&(h=new C(a),fb(e,h,a,c),N(e,g,h),b.fn.call(e,g,h));return d},b.type&&(x.drawings[b.type]=b.name)),a.fn[b.name]},a.fn.getEventHooks=function(){var b,c,a=this,d={};return 0!==a.length&&(b=a[0],c=S(b),d=c.eventHooks),d},a.fn.setEventHooks=function(a){var c,d,b=this;for(c=0;c<b.length;c+=1)d=S(b[c]),k(d.eventHooks,a);return b},a.fn.getLayers=function(a){var c,d,e,f,g,b=this,h=[];if(0!==b.length)if(c=b[0],d=S(c),e=d.layers,n(a))for(g=0;g<e.length;g+=1)f=e[g],a.call(c,f)&&h.push(f);else h=e;return h},a.fn.getLayer=function(a){var c,d,e,f,g,h,b=this;if(0!==b.length)if(c=b[0],d=S(c),e=d.layers,h=m(a),a&&a.layer)f=a;else if("number"===h)0>a&&(a=e.length+a),f=e[a];else if("regexp"===h){for(g=0;g<e.length;g+=1)if(F(e[g].name)&&e[g].name.match(a)){f=e[g];break}}else f=d.layer.names[a];return f},a.fn.getLayerGroup=function(a){var c,d,e,f,g,b=this,h=m(a);if(0!==b.length)if(c=b[0],"array"===h)g=a;else if("regexp"===h){d=S(c),e=d.layer.groups;for(f in e)if(f.match(a)){g=e[f];break}}else d=S(c),g=d.layer.groups[a];return g},a.fn.getLayerIndex=function(a){var b=this,c=b.getLayers(),d=b.getLayer(a);return l(d,c)},a.fn.setLayer=function(b,c){var e,f,g,h,j,l,n,d=this;for(f=0;f<d.length;f+=1)if(e=a(d[f]),g=S(d[f]),h=a(d[f]).getLayer(b)){X(e,g,h,c),Y(e,g,h,c),I(c);for(j in c)Object.prototype.hasOwnProperty.call(c,j)&&(l=c[j],n=m(l),"object"===n&&o(l)?(h[j]=k({},l),I(h[j])):"array"===n?h[j]=l.slice(0):"string"===n?0===l.indexOf("+=")?h[j]+=i(l.substr(2)):0===l.indexOf("-=")?h[j]-=i(l.substr(2)):h[j]=!isNaN(l)&&G(l)&&"text"!==j?i(l):l:h[j]=l);T(e,g,h),W(e,g,h),a.isEmptyObject(c)===!1&&eb(e,g,h,"change",c)}return d},a.fn.setLayers=function(b,c){var e,f,g,h,d=this;for(f=0;f<d.length;f+=1)for(e=a(d[f]),g=e.getLayers(c),h=0;h<g.length;h+=1)e.setLayer(g[h],b);return d},a.fn.setLayerGroup=function(b,c){var e,f,g,h,d=this;for(f=0;f<d.length;f+=1)if(e=a(d[f]),g=e.getLayerGroup(b))for(h=0;h<g.length;h+=1)e.setLayer(g[h],c);return d},a.fn.moveLayer=function(b,c){var e,f,g,h,i,d=this;for(f=0;f<d.length;f+=1)e=a(d[f]),g=S(d[f]),h=g.layers,i=e.getLayer(b),i&&(i.index=l(i,h),h.splice(i.index,1),h.splice(c,0,i),0>c&&(c=h.length+c),i.index=c,eb(e,g,i,"move"));return d},a.fn.removeLayer=function(b){var d,e,f,g,h,c=this;for(e=0;e<c.length;e+=1)d=a(c[e]),f=S(c[e]),g=d.getLayers(),h=d.getLayer(b),h&&(h.index=l(h,g),g.splice(h.index,1),delete h._layer,X(d,f,h,{name:null}),Y(d,f,h,{groups:null}),eb(d,f,h,"remove"));return c},a.fn.removeLayers=function(b){var d,e,f,g,h,i,c=this;for(e=0;e<c.length;e+=1){for(d=a(c[e]),f=S(c[e]),g=d.getLayers(b),i=0;i<g.length;i+=1)h=g[i],d.removeLayer(h),i-=1;f.layer.names={},f.layer.groups={}}return c},a.fn.removeLayerGroup=function(b){var d,e,f,g,c=this;if(void 0!==b)for(e=0;e<c.length;e+=1)if(d=a(c[e]),f=d.getLayerGroup(b))for(f=f.slice(0),g=0;g<f.length;g+=1)d.removeLayer(f[g]);return c},a.fn.addLayerToGroup=function(b,c){var e,f,g,d=this,h=[c];for(f=0;f<d.length;f+=1)e=a(d[f]),g=e.getLayer(b),g.groups&&(h=g.groups.slice(0),-1===l(c,g.groups)&&h.push(c)),e.setLayer(g,{groups:h});return d},a.fn.removeLayerFromGroup=function(b,c){var e,f,g,i,d=this,h=[];for(f=0;f<d.length;f+=1)e=a(d[f]),g=e.getLayer(b),g.groups&&(i=l(c,g.groups),-1!==i&&(h=g.groups.slice(0),h.splice(i,1),e.setLayer(g,{groups:h})));return d},A.cursors=["grab","grabbing","zoom-in","zoom-out"],A.prefix=function(){var a=f(c.documentElement,""),b=(v.call(a).join("").match(/-(moz|webkit|ms)-/)||""===a.OLink&&["","o"])[1];return"-"+b+"-"}(),a.fn.triggerLayerEvent=function(b,c){var e,f,g,d=this;for(f=0;f<d.length;f+=1)e=a(d[f]),g=S(d[f]),b=e.getLayer(b),b&&eb(e,g,b,c);return d},a.fn.drawLayer=function(b){var d,e,f,g,c=this;for(d=0;d<c.length;d+=1)f=a(c[d]),e=H(c[d]),e&&(g=f.getLayer(b),$(f,e,g));return c},a.fn.drawLayers=function(b){var d,e,f,h,i,j,k,l,m,n,o,p,q,c=this,g=b||{};for(l=g.index,l||(l=0),e=0;e<c.length;e+=1)if(d=a(c[e]),f=H(c[e])){for(n=S(c[e]),g.clear!==!1&&d.clearCanvas(),h=n.layers,k=l;k<h.length;k+=1)if(i=h[k],i.index=k,g.resetFire&&(i._fired=!1),$(d,f,i,k+1),i._masks=n.transforms.masks.slice(0),i._method===a.fn.drawImage&&i.visible){q=!0;break}if(q)break;m=k,i=Z(n),o=n.event,p=o.type,n.drag.layer&&_(d,n,p),j=n.lastIntersected,null===j||i===j||!j._hovered||j._fired||n.drag.dragging||(n.lastIntersected=null,j._fired=!0,j._hovered=!1,eb(d,n,j,"mouseout"),bb(d,n)),i&&(i[p]||(p=ob(p)),i._event&&i.intersects&&(n.lastIntersected=i,(i.mouseover||i.mouseout||i.cursors)&&!n.drag.dragging&&(i._hovered||i._fired||(i._fired=!0,i._hovered=!0,eb(d,n,i,"mouseover"))),i._fired||(i._fired=!0,o.type=null,eb(d,n,i,p)),!i.draggable||i.disableEvents||"mousedown"!==p&&"touchstart"!==p||(n.drag.layer=i,n.originalRedrawOnMousemove=n.redrawOnMousemove,n.redrawOnMousemove=!0))),null!==i||n.drag.dragging||bb(d,n),m===h.length&&(n.intersecting.length=0,n.transforms=J(z),n.savedTransforms.length=0)}return c},a.fn.addLayer=function(a){var c,d,e,b=this;for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(e=new C(a),e.layer=!0,fb(b[c],e,a));return b},A.props=["width","height","opacity","lineHeight"],A.propsObj={},a.fn.animateLayer=function(){function j(a,b,c){return function(){gb(c),jb(c),b.animating&&b.animated!==c||a.drawLayers(),c._animating=!1,b.animating=!1,b.animated=null,f[4]&&f[4].call(a[0],c),eb(a,b,c,"animateend")}}function l(a,b,c){return function(d,e){var g,h,i,j=!1;"_"===e.prop[0]&&(j=!0,e.prop=e.prop.replace("_",""),c[e.prop]=c["_"+e.prop]),-1!==e.prop.indexOf(".")&&(g=e.prop.split("."),h=g[0],i=g[1],c[h]&&(c[h][i]=e.now)),c._pos!==e.pos&&(c._pos=e.pos,c._animating||b.animating||(c._animating=!0,b.animating=!0,b.animated=c),b.animating&&b.animated!==c||a.drawLayers()),f[5]&&f[5].call(a[0],d,e,c),eb(a,b,c,"animate",e),j&&(e.prop="_"+e.prop)}}var c,d,e,g,h,i,b=this,f=v.call(arguments,0);for("object"===m(f[2])?(f.splice(2,0,f[2].duration||null),f.splice(3,0,f[3].easing||null),f.splice(4,0,f[4].complete||null),f.splice(5,0,f[5].step||null)):(void 0===f[2]?(f.splice(2,0,null),f.splice(3,0,null),f.splice(4,0,null)):n(f[2])&&(f.splice(2,0,null),f.splice(3,0,null)),void 0===f[3]?(f[3]=null,f.splice(4,0,null)):n(f[3])&&f.splice(3,0,null)),d=0;d<b.length;d+=1)c=a(b[d]),e=H(b[d]),e&&(g=S(b[d]),h=c.getLayer(f[0]),h&&h._method!==a.fn.draw&&(i=k({},f[1]),i=ib(b[d],h,i),hb(i,!0),hb(h),h.style=A.propsObj,a(h).animate(i,{duration:f[2],easing:a.easing[f[3]]?f[3]:null,complete:j(c,g,h),step:l(c,g,h)}),eb(c,g,h,"animatestart")));return b},a.fn.animateLayerGroup=function(b){var d,e,g,h,c=this,f=v.call(arguments,0);for(e=0;e<c.length;e+=1)if(d=a(c[e]),g=d.getLayerGroup(b))for(h=0;h<g.length;h+=1)f[0]=g[h],d.animateLayer.apply(d,f);return c},a.fn.delayLayer=function(b,c){var e,f,g,h,d=this;for(c=c||0,f=0;f<d.length;f+=1)e=a(d[f]),g=S(d[f]),h=e.getLayer(b),h&&(a(h).delay(c),eb(e,g,h,"delay"));return d},a.fn.delayLayerGroup=function(b,c){var e,f,g,h,i,d=this;for(c=c||0,f=0;f<d.length;f+=1)if(e=a(d[f]),g=e.getLayerGroup(b))for(i=0;i<g.length;i+=1)h=g[i],e.delayLayer(h,c);return d},a.fn.stopLayer=function(b,c){var e,f,g,h,d=this;for(f=0;f<d.length;f+=1)e=a(d[f]),g=S(d[f]),h=e.getLayer(b),h&&(a(h).stop(c),eb(e,g,h,"stop"));return d},a.fn.stopLayerGroup=function(b,c){var e,f,g,h,i,d=this;for(f=0;f<d.length;f+=1)if(e=a(d[f]),g=e.getLayerGroup(b))for(i=0;i<g.length;i+=1)h=g[i],e.stopLayer(h,c);return d},mb(["color","backgroundColor","borderColor","borderTopColor","borderRightColor","borderBottomColor","borderLeftColor","fillStyle","outlineColor","strokeStyle","shadowColor"]),x.touchEvents={mousedown:"touchstart",mouseup:"touchend",mousemove:"touchmove"},x.mouseEvents={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"},qb(["click","dblclick","mousedown","mouseup","mousemove","mouseover","mouseout","touchstart","touchmove","touchend","pointerdown","pointermove","pointerup","contextmenu"]),a.event.fix=function(b){var c,d,e,f,g;if(b=w.call(a.event,b),d=b.originalEvent,f=1,d)if(d.preventDefault(),g=d.target,"CANVAS"==g.tagName&&g.getAttribute("jcanvasScale")&&(f=parseInt(g.getAttribute("jcanvasScale"))),e=d.changedTouches,void 0!==b.pageX&&void 0===b.offsetX){c=a(b.currentTarget).offset();try{c&&(b.offsetX=(b.pageX-c.left)*f,b.offsetY=(b.pageY-c.top)*f)}catch(h){}}else if(e)try{c=a(b.currentTarget).offset(),c&&(b.offsetX=(e[0].pageX-c.left)*f,b.offsetY=(e[0].pageY-c.top)*f)}catch(h){}return b},x.drawings={arc:"drawArc",bezier:"drawBezier",ellipse:"drawEllipse","function":"draw",image:"drawImage",line:"drawLine",path:"drawPath",polygon:"drawPolygon",slice:"drawSlice",quadratic:"drawQuadratic",rectangle:"drawRect",text:"drawText",vector:"drawVector",save:"saveCanvas",restore:"restoreCanvas",rotate:"rotateCanvas",scale:"scaleCanvas",translate:"translateCanvas"},a.fn.draw=function ic(a){var c,d,b=this,e=new C(a);if(x.drawings[e.type]&&"function"!==e.type)b[x.drawings[e.type]](a);else for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(e=new C(a),fb(b[c],e,a,ic),e.visible&&e.fn&&e.fn.call(b[c],d,e));return b},a.fn.clearCanvas=function jc(a){var c,d,b=this,e=new C(a);for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(null===e.width||null===e.height?(d.save(),d.setTransform(1,0,0,1,0,0),d.clearRect(0,0,b[c].width,b[c].height),d.restore()):(fb(b[c],e,a,jc),R(b[c],d,e,e.width,e.height),d.clearRect(e.x-e.width/2,e.y-e.height/2,e.width,e.height),P(d,e)));return b},a.fn.saveCanvas=function kc(a){var c,d,e,f,g,b=this;for(c=0;c<b.length;c+=1)if(d=H(b[c]))for(f=S(b[c]),e=new C(a),fb(b[c],e,a,kc),g=0;g<e.count;g+=1)K(d,f);return b},a.fn.restoreCanvas=function lc(a){var c,d,e,f,g,b=this;for(c=0;c<b.length;c+=1)if(d=H(b[c]))for(f=S(b[c]),e=new C(a),fb(b[c],e,a,lc),g=0;g<e.count;g+=1)L(d,f);return b},a.fn.rotateCanvas=function mc(a){var c,d,e,f,b=this;for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(f=S(b[c]),e=new C(a),fb(b[c],e,a,mc),e.autosave&&K(d,f),sb(d,e,f.transforms));return b},a.fn.scaleCanvas=function nc(a){var c,d,e,f,b=this;for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(f=S(b[c]),e=new C(a),fb(b[c],e,a,nc),e.autosave&&K(d,f),tb(d,e,f.transforms));return b},a.fn.translateCanvas=function oc(a){var c,d,e,f,b=this;for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(f=S(b[c]),e=new C(a),fb(b[c],e,a,oc),e.autosave&&K(d,f),ub(d,e,f.transforms));return b},a.fn.drawRect=function pc(a){var c,d,e,f,g,h,i,j,k,b=this;for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(e=new C(a),fb(b[c],e,a,pc),e.visible&&(R(b[c],d,e,e.width,e.height),N(b[c],d,e),d.beginPath(),e.width&&e.height&&(f=e.x-e.width/2,g=e.y-e.height/2,j=r(e.cornerRadius),j?(h=e.x+e.width/2,i=e.y+e.height/2,e.width<0&&(k=f,f=h,h=k),e.height<0&&(k=g,g=i,i=k),0>h-f-2*j&&(j=(h-f)/2),0>i-g-2*j&&(j=(i-g)/2),d.moveTo(f+j,g),d.lineTo(h-j,g),d.arc(h-j,g+j,j,3*p/2,2*p,!1),d.lineTo(h,i-j),d.arc(h-j,i-j,j,0,p/2,!1),d.lineTo(f+j,i),d.arc(f+j,i-j,j,p/2,p,!1),d.lineTo(f,g+j),d.arc(f+j,g+j,j,p,3*p/2,!1),e.closed=!0):d.rect(f,g,e.width,e.height)),rb(b[c],d,e),Q(b[c],d,e)));return b},a.fn.drawArc=function qc(a){var c,d,e,b=this;for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(e=new C(a),fb(b[c],e,a,qc),e.visible&&(R(b[c],d,e,2*e.radius),N(b[c],d,e),d.beginPath(),yb(b[c],d,e,e),rb(b[c],d,e),Q(b[c],d,e)));return b},a.fn.drawEllipse=function rc(a){var c,d,e,f,g,b=this;for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(e=new C(a),fb(b[c],e,a,rc),e.visible&&(R(b[c],d,e,e.width,e.height),N(b[c],d,e),f=e.width*(4/3),g=e.height,d.beginPath(),d.moveTo(e.x,e.y-g/2),d.bezierCurveTo(e.x-f/2,e.y-g/2,e.x-f/2,e.y+g/2,e.x,e.y+g/2),d.bezierCurveTo(e.x+f/2,e.y+g/2,e.x+f/2,e.y-g/2,e.x,e.y-g/2),rb(b[c],d,e),e.closed=!0,Q(b[c],d,e)));return b},a.fn.drawPolygon=function sc(a){var c,d,e,f,g,h,i,j,k,l,b=this;for(c=0;c<b.length;c+=1)if(d=H(b[c]),d&&(e=new C(a),fb(b[c],e,a,sc),e.visible)){for(R(b[c],d,e,2*e.radius),N(b[c],d,e),g=2*p/e.sides,h=g/2,f=h+p/2,i=e.radius*t(h),d.beginPath(),l=0;l<e.sides;l+=1)j=e.x+e.radius*t(f),k=e.y+e.radius*s(f),d.lineTo(j,k),e.concavity&&(j=e.x+(i+-i*e.concavity)*t(f+h),k=e.y+(i+-i*e.concavity)*s(f+h),d.lineTo(j,k)),f+=g;rb(b[c],d,e),e.closed=!0,Q(b[c],d,e)}return b},a.fn.drawSlice=function tc(a){var c,d,e,f,g,h,b=this;for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(e=new C(a),fb(b[c],e,a,tc),e.visible&&(R(b[c],d,e,2*e.radius),N(b[c],d,e),e.start*=e._toRad,e.end*=e._toRad,e.start-=p/2,e.end-=p/2,e.start=vb(e.start),e.end=vb(e.end),e.end<e.start&&(e.end+=2*p),f=(e.start+e.end)/2,g=e.radius*e.spread*t(f),h=e.radius*e.spread*s(f),e.x+=g,e.y+=h,d.beginPath(),d.arc(e.x,e.y,e.radius,e.start,e.end,e.ccw),d.lineTo(e.x,e.y),rb(b[c],d,e),e.closed=!0,Q(b[c],d,e)));return b},a.fn.drawLine=function uc(a){var c,d,e,b=this;for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(e=new C(a),fb(b[c],e,a,uc),e.visible&&(R(b[c],d,e),N(b[c],d,e),d.beginPath(),Cb(b[c],d,e,e),rb(b[c],d,e),Q(b[c],d,e)));return b},a.fn.drawQuadratic=function vc(a){var c,d,e,b=this;for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(e=new C(a),fb(b[c],e,a,vc),e.visible&&(R(b[c],d,e),N(b[c],d,e),d.beginPath(),Db(b[c],d,e,e),rb(b[c],d,e),Q(b[c],d,e)));return b},a.fn.drawBezier=function wc(a){var c,d,e,b=this;for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(e=new C(a),fb(b[c],e,a,wc),e.visible&&(R(b[c],d,e),N(b[c],d,e),d.beginPath(),Eb(b[c],d,e,e),rb(b[c],d,e),Q(b[c],d,e)));return b},a.fn.drawVector=function xc(a){var c,d,e,b=this;for(c=0;c<b.length;c+=1)d=H(b[c]),d&&(e=new C(a),fb(b[c],e,a,xc),e.visible&&(R(b[c],d,e),N(b[c],d,e),d.beginPath(),Hb(b[c],d,e,e),rb(b[c],d,e),Q(b[c],d,e)));return b},a.fn.drawPath=function yc(a){var c,d,e,f,g,b=this;for(c=0;c<b.length;c+=1)if(d=H(b[c]),d&&(e=new C(a),fb(b[c],e,a,yc),e.visible)){for(R(b[c],d,e),N(b[c],d,e),d.beginPath(),f=1;;){if(g=e["p"+f],void 0===g)break;g=new C(g),"line"===g.type?Cb(b[c],d,e,g):"quadratic"===g.type?Db(b[c],d,e,g):"bezier"===g.type?Eb(b[c],d,e,g):"vector"===g.type?Hb(b[c],d,e,g):"arc"===g.type&&yb(b[c],d,e,g),f+=1}rb(b[c],d,e),Q(b[c],d,e)}return b},a.fn.drawText=function zc(a){var c,d,e,f,g,h,j,k,m,n,o,q,r,s,b=this,l=500;for(c=0;c<b.length;c+=1)if(d=H(b[c]),d&&(e=new C(a),fb(b[c],e,a,zc),e.visible)){if(d.textBaseline=e.baseline,d.textAlign=e.align,Ib(b[c],d,e),g=null!==e.maxWidth?Kb(d,e):e.text.toString().split("\n"),Jb(b[c],d,e,g),f&&(f.width=e.width,f.height=e.height),R(b[c],d,e,e.width,e.height),N(b[c],d,e),r=e.x,"left"===e.align?e.respectAlign?e.x+=e.width/2:r-=e.width/2:"right"===e.align&&(e.respectAlign?e.x-=e.width/2:r+=e.width/2),e.radius)for(k=i(e.fontSize),null===e.letterSpacing&&(e.letterSpacing=k/l),j=0;j<g.length;j+=1){for(d.save(),d.translate(e.x,e.y),h=g[j],e.flipArcText&&(n=h.split(""),n.reverse(),h=n.join("")),m=h.length,d.rotate(-(p*e.letterSpacing*(m-1))/2),q=0;m>q;q+=1)o=h[q],0!==q&&d.rotate(p*e.letterSpacing),d.save(),d.translate(0,-e.radius),e.flipArcText&&d.scale(-1,-1),d.fillText(o,0,0),"transparent"!==e.fillStyle&&(d.shadowColor="transparent"),0!==e.strokeWidth&&d.strokeText(o,0,0),d.restore();e.radius-=k,e.letterSpacing+=k/(2*l*p),d.restore()}else for(j=0;j<g.length;j+=1)h=g[j],s=e.y+j*e.height/g.length-(g.length-1)*e.height/g.length/2,d.shadowColor=e.shadowColor,d.fillText(h,r,s),"transparent"!==e.fillStyle&&(d.shadowColor="transparent"),0!==e.strokeWidth&&d.strokeText(h,r,s);s=0,"top"===e.baseline?s+=e.height/2:"bottom"===e.baseline&&(s-=e.height/2),e._event&&(d.beginPath(),d.rect(e.x-e.width/2,e.y-e.height/2+s,e.width,e.height),rb(b[c],d,e),d.closePath()),P(d,e)}return y.propCache=e,b},a.fn.measureText=function(a){var c,d,e,b=this;return d=b.getLayer(a),(!d||d&&!d._layer)&&(d=new C(a)),c=H(b[0]),c&&(Ib(b[0],c,d),e=Kb(c,d),Jb(b[0],c,d,e)),d},a.fn.drawImage=function Bc(b){function o(a,b,c,d,e){null===d.width&&null===d.sWidth&&(d.width=d.sWidth=k.width),null===d.height&&null===d.sHeight&&(d.height=d.sHeight=k.height),e&&(e.width=d.width,e.height=d.height),null!==d.sWidth&&null!==d.sHeight&&null!==d.sx&&null!==d.sy?(null===d.width&&(d.width=d.sWidth),null===d.height&&(d.height=d.sHeight),d.cropFromCenter&&(d.sx+=d.sWidth/2,d.sy+=d.sHeight/2),d.sy-d.sHeight/2<0&&(d.sy=d.sHeight/2),d.sy+d.sHeight/2>k.height&&(d.sy=k.height-d.sHeight/2),d.sx-d.sWidth/2<0&&(d.sx=d.sWidth/2),d.sx+d.sWidth/2>k.width&&(d.sx=k.width-d.sWidth/2),R(a,b,d,d.width,d.height),N(a,b,d),b.drawImage(k,d.sx-d.sWidth/2,d.sy-d.sHeight/2,d.sWidth,d.sHeight,d.x-d.width/2,d.y-d.height/2,d.width,d.height)):(R(a,b,d,d.width,d.height),N(a,b,d),b.drawImage(k,d.x-d.width/2,d.y-d.height/2,d.width,d.height)),b.beginPath(),b.rect(d.x-d.width/2,d.y-d.height/2,d.width,d.height),rb(a,b,d),b.closePath(),P(b,d),O(b,c,d)}function p(b,c,d,e,f){return function(){var g=a(b);o(b,c,d,e,f),e.layer?eb(g,d,f,"load"):e.load&&e.load.call(g[0],f),e.layer&&(f._masks=d.transforms.masks.slice(0),e._next&&g.drawLayers({clear:!1,resetFire:!0,index:e._next}))}}var e,f,g,h,i,j,k,l,m,c=this,n=y.imageCache;for(f=0;f<c.length;f+=1)e=c[f],g=H(c[f]),g&&(h=S(c[f]),i=new C(b),j=fb(c[f],i,b,Bc),i.visible&&(m=i.source,l=m.getContext,m.src||l?k=m:m&&(n[m]&&n[m].complete?k=n[m]:(k=new d,m.match(/^data:/i)||(k.crossOrigin=i.crossOrigin),k.src=m,n[m]=k)),k&&(k.complete||l?p(e,g,h,i,j)():(k.onload=p(e,g,h,i,j),k.src=k.src))));return c},a.fn.createPattern=function(b){function k(){i=e.createPattern(g,f.repeat),f.load&&f.load.call(c[0],i)
}var e,f,g,h,i,j,c=this;return e=H(c[0]),e?(f=new C(b),j=f.source,n(j)?(g=a("<canvas />")[0],g.width=f.width,g.height=f.height,h=H(g),j.call(g,h),k()):(h=j.getContext,j.src||h?g=j:(g=new d,j.match(/^data:/i)||(g.crossOrigin=f.crossOrigin),g.src=j),g.complete||h?k():(g.onload=k,g.src=g.src))):i=null,i},a.fn.createGradient=function(a){var c,d,e,g,h,i,j,k,l,m,b=this,f=[];if(d=new C(a),c=H(b[0])){for(d.x1=d.x1||0,d.y1=d.y1||0,d.x2=d.x2||0,d.y2=d.y2||0,e=null!==d.r1&&null!==d.r2?c.createRadialGradient(d.x1,d.y1,d.r1,d.x2,d.y2,d.r2):c.createLinearGradient(d.x1,d.y1,d.x2,d.y2),j=1;void 0!==d["c"+j];j+=1)void 0!==d["s"+j]?f.push(d["s"+j]):f.push(null);for(g=f.length,null===f[0]&&(f[0]=0),null===f[g-1]&&(f[g-1]=1),j=0;g>j;j+=1){if(null!==f[j]){for(l=1,m=0,h=f[j],k=j+1;g>k;k+=1){if(null!==f[k]){i=f[k];break}l+=1}h>i&&(f[k]=f[j])}else null===f[j]&&(m+=1,f[j]=h+m*((i-h)/l));e.addColorStop(f[j],d["c"+(j+1)])}}else e=null;return e},a.fn.setPixels=function Ec(a){var c,d,e,f,g,h,i,j,k,l,b=this;for(d=0;d<b.length;d+=1)if(c=b[d],e=H(c),f=S(b[d]),e&&(g=new C(a),fb(c,g,a,Ec),R(b[d],e,g,g.width,g.height),(null===g.width||null===g.height)&&(g.width=c.width,g.height=c.height,g.x=g.width/2,g.y=g.height/2),0!==g.width&&0!==g.height)){if(i=e.getImageData((g.x-g.width/2)*f.pixelRatio,(g.y-g.height/2)*f.pixelRatio,g.width*f.pixelRatio,g.height*f.pixelRatio),j=i.data,l=j.length,g.each)for(k=0;l>k;k+=4)h={r:j[k],g:j[k+1],b:j[k+2],a:j[k+3]},g.each.call(c,h,g),j[k]=h.r,j[k+1]=h.g,j[k+2]=h.b,j[k+3]=h.a;e.putImageData(i,(g.x-g.width/2)*f.pixelRatio,(g.y-g.height/2)*f.pixelRatio),e.restore()}return b},a.fn.getCanvasImage=function(a,b){var d,c=this,e=null;return 0!==c.length&&(d=c[0],d.toDataURL&&(void 0===b&&(b=1),e=d.toDataURL("image/"+a,b))),e},a.fn.detectPixelRatio=function(a){var d,e,f,g,h,i,j,k,l,c=this;for(e=0;e<c.length;e+=1)d=c[e],f=H(d),l=S(c[e]),l.scaled||(g=b.devicePixelRatio||1,h=f.webkitBackingStorePixelRatio||f.mozBackingStorePixelRatio||f.msBackingStorePixelRatio||f.oBackingStorePixelRatio||f.backingStorePixelRatio||1,i=g/h,1!==i&&(j=d.width,k=d.height,d.width=j*i,d.height=k*i,d.style.width=j+"px",d.style.height=k+"px",f.scale(i,i)),l.pixelRatio=i,l.scaled=!0,a&&a.call(d,i));return c},D.clearCache=function(){var a;for(a in y)Object.prototype.hasOwnProperty.call(y,a)&&(y[a]={})},a.support.canvas=void 0!==a("<canvas />")[0].getContext,k(D,{defaults:j,setGlobalProps:N,transformShape:R,detectEvents:rb,closePath:Q,setCanvasFont:Ib,measureText:Jb}),a.jCanvas=D,a.jCanvasObject=C});